<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë‹¤ìš´ë¡œë“œ</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto; padding: 24px; }
    a { text-decoration: none; }
    li { margin: 10px 0; }
    .muted { color: #666; font-size: 12px; }
  </style>
</head>
<body>
  <h2>ðŸ“¦ ë‹¤ìš´ë¡œë“œ</h2>
  <div id="status" class="muted">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  <ul id="list"></ul>

<script>
  const owner = "chekyu";
  const repo  = "down";
  const branch = "main";
  const folderPath = "downloads"; // ë ˆí¬ ë‚´ í´ë”

  const api = `https://api.github.com/repos/${owner}/${repo}/contents/${folderPath}?ref=${branch}`;

  function bytesToSize(bytes) {
    if (bytes === 0) return "0 B";
    const k = 1024, sizes = ["B","KB","MB","GB"];
    const i = Math.floor(Math.log(bytes)/Math.log(k));
    return (bytes/Math.pow(k,i)).toFixed(i===0?0:1) + " " + sizes[i];
  }

  fetch(api)
    .then(r => {
      if (!r.ok) throw new Error(`GitHub API ì˜¤ë¥˜: ${r.status}`);
      return r.json();
    })
    .then(items => {
      const list = document.getElementById("list");
      const status = document.getElementById("status");

      // íŒŒì¼ë§Œ í•„í„°ë§
      const files = items.filter(x => x.type === "file");

      if (files.length === 0) {
        status.textContent = "ë‹¤ìš´ë¡œë“œí•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }

      status.textContent = `íŒŒì¼ ${files.length}ê°œ`;

      files.forEach(f => {
        const li = document.createElement("li");

        // âœ… download_urlì€ raw íŒŒì¼ ë§í¬(ë°”ë¡œ ë‹¤ìš´ë¡œë“œ/ì—´ë¦¼)
        const a = document.createElement("a");
        a.href = f.download_url;
        a.textContent = f.name;

        const meta = document.createElement("div");
        meta.className = "muted";
        meta.textContent = `í¬ê¸°: ${bytesToSize(f.size)}`;

        li.appendChild(a);
        li.appendChild(meta);
        list.appendChild(li);
      });
    })
    .catch(err => {
      document.getElementById("status").textContent = err.message;
    });
</script>
</body>
</html>
